import { useState, useEffect } from 'react';\r\nimport { testGoogleSheetsAccess, getPublicAccessInstructions } from '@/lib/googleSheetsTest';\r\nimport { RefreshCw, CheckCircle, XCircle, AlertTriangle } from 'lucide-react';\r\n\r\nexport default function TestGoogleSheets() {\r\n  const [testResults, setTestResults] = useState<any>(null);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n\r\n  const runTest = async () => {\r\n    setIsLoading(true);\r\n    try {\r\n      const results = await testGoogleSheetsAccess();\r\n      setTestResults(results);\r\n    } catch (error) {\r\n      console.error('Test failed:', error);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    runTest();\r\n  }, []);\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-background p-4 md:p-6 lg:p-8\">\r\n      <div className=\"max-w-[1200px] mx-auto\">\r\n        <div className=\"glass-card rounded-xl p-8\">\r\n          <div className=\"flex items-center gap-3 mb-6\">\r\n            <AlertTriangle className=\"w-8 h-8 text-warning\" />\r\n            <h1 className=\"text-3xl font-bold\">Google Sheets Connection Test</h1>\r\n          </div>\r\n          \r\n          <div className=\"space-y-6\">\r\n            <div className=\"flex gap-4\">\r\n              <button\r\n                onClick={runTest}\r\n                disabled={isLoading}\r\n                className=\"px-6 py-3 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors flex items-center gap-2 disabled:opacity-50\"\r\n              >\r\n                <RefreshCw className={`w-5 h-5 ${isLoading ? 'animate-spin' : ''}`} />\r\n                {isLoading ? 'Testing...' : 'Test All Sheets'}\r\n              </button>\r\n            </div>\r\n\r\n            {testResults && (\r\n              <div>\r\n                <h2 className=\"text-2xl font-semibold mb-4\">ðŸ“Š Test Results</h2>\r\n                <div className=\"grid gap-4\">\r\n                  {Object.entries(testResults).map(([name, result]: [string, any]) => (\r\n                    <div key={name} className=\"bg-muted/50 rounded-lg p-4\">\r\n                      <div className=\"flex items-center gap-3 mb-2\">\r\n                        {result.accessible ? (\r\n                          <CheckCircle className=\"w-6 h-6 text-green-600\" />\r\n                        ) : (\r\n                          <XCircle className=\"w-6 h-6 text-red-600\" />\r\n                        )}\r\n                        <h3 className=\"text-lg font-semibold capitalize\">{name} Dashboard</h3>\r\n                        <span className={`px-2 py-1 rounded text-sm ${\r\n                          result.accessible \r\n                            ? 'bg-green-100 text-green-800' \r\n                            : 'bg-red-100 text-red-800'\r\n                        }`}>\r\n                          {result.accessible ? 'Connected' : 'Failed'}\r\n                        </span>\r\n                      </div>\r\n                      \r\n                      {result.accessible ? (\r\n                        <div className=\"text-sm text-muted-foreground space-y-1\">\r\n                          <p>âœ… Data loaded: {result.responseLength} characters</p>\r\n                          <p>âœ… Working URL: {result.workingUrl}</p>\r\n                          <p>âœ… Headers: {result.firstLine}</p>\r\n                        </div>\r\n                      ) : (\r\n                        <div className=\"text-sm text-red-600\">\r\n                          <p>âŒ All URLs failed - Sheet may not be public or empty</p>\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            <div>\r\n              <h2 className=\"text-2xl font-semibold mb-4\">ðŸ› ï¸ How to Fix Issues</h2>\r\n              <div className=\"bg-muted/50 rounded-lg p-6\">\r\n                <pre className=\"text-sm whitespace-pre-wrap font-mono\">{getPublicAccessInstructions()}</pre>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">\r\n              <h3 className=\"font-semibold text-blue-900 mb-2\">ðŸ’¡ Quick Fix Steps:</h3>\r\n              <ol className=\"list-decimal list-inside space-y-1 text-blue-800 text-sm\">\r\n                <li>Open each Google Sheet</li>\r\n                <li>Click \"Share\" button (top right)</li>\r\n                <li>Change to \"Anyone with the link can view\"</li>\r\n                <li>Make sure first row has column headers</li>\r\n                <li>Make sure there's data in rows below headers</li>\r\n                <li>Click \"Test All Sheets\" button above</li>\r\n              </ol>\r\n            </div>\r\n\r\n            <div className=\"flex gap-4\">\r\n              <button\r\n                onClick={() => window.open('/sales', '_blank')}\r\n                className=\"px-4 py-2 bg-secondary text-secondary-foreground rounded-lg hover:bg-secondary/90 transition-colors\"\r\n              >\r\n                Go to Sales Overview\r\n              </button>\r\n              <button\r\n                onClick={() => window.open('/marketing', '_blank')}\r\n                className=\"px-4 py-2 bg-secondary text-secondary-foreground rounded-lg hover:bg-secondary/90 transition-colors\"\r\n              >\r\n                Go to Marketing Dashboard\r\n              </button>\r\n              <button\r\n                onClick={() => window.open('/finance', '_blank')}\r\n                className=\"px-4 py-2 bg-secondary text-secondary-foreground rounded-lg hover:bg-secondary/90 transition-colors\"\r\n              >\r\n                Go to Finance Dashboard\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}
